/**
 * @package    JGive
 *
 * @author     Techjoomla <extensions@techjoomla.com>
 * @copyright  Copyright (c) 2009-2018 TechJoomla. All rights reserved.
 * @license    GNU General Public License version 2 or later.
 */
var jgive={toggleDiv:function(e){1==localStorage.getItem("flag")?localStorage.setItem("flag",0):localStorage.setItem("flag",1),jQuery(window).width()<767&&jQuery("#"+e).toggle(),jQuery(".campaign__filter").toggleClass("af-d-none active"),"displayFilterText"==e&&(jQuery(".tjBs5").length?jQuery(".campaign__filter").hasClass("active")?jQuery(".fa-filter").parent().removeClass("text-black"):jQuery(".fa-filter").parent().addClass("text-black"):jQuery(".fa-filter").toggleClass("btn btn-primary btn-sm p-10"))},toggleSearch:function(e){0==localStorage.getItem("filter")?localStorage.setItem("filter",1):localStorage.setItem("filter",0),"SearchFilterInputBox"==e&&(jQuery(".search__campaign").toggleClass("active af-d-none"),jQuery(".fa-search").toggleClass("btn btn-primary btn-sm p-10"))},searchCampaigns:function(e){if("13"==e.keyCode)return jgiveCommon.filters.submitFilters("adminForm4"),!1},jgShowSortFilter:function(){1==localStorage.getItem("dropdown")?localStorage.setItem("dropdown",0):localStorage.setItem("dropdown",1),jQuery("#filter_order").toggle()},campaignDetails:{init:function(){techjoomla.jQuery(document).ready((function(){jgive.campaignDetails.onChangeGetDonationData(),jgive.campaignDetails.onChangefun(),jgive.campaignDetails.campaignImgPopup(),jgive.campaignDetails.loadActivity()}))},onChangeGetDonationData:function(){techjoomla.jQuery("#campaigns_graph_period").change((function(){var e=document.getElementById("campaigns_graph_period").value,t=document.getElementById("camp_id").value;techjoomla.jQuery.ajax({type:"GET",url:"?option=com_jgive&view=campaigns&task=campaign.getCampaignGraphData&format=json&cid="+t+"&filtervalue="+e,dataType:"json",sucess:function(e){},error:function(e){console.log("error")}}).done((function(e){var t=document.getElementById("mycampaign_graph").getContext("2d");new Chart(t,{type:"line",data:{labels:e.data.donationDate,datasets:[{label:e.data.totalDonation?e.data.totalDonation:0,data:e.data.donationAmount?e.data.donationAmount:0,backgroundColor:"rgba(203, 235, 230, 0.5)",borderColor:"rgba(55, 179, 142, 1)",lineTension:"0",borderWidth:"2",pointRadius:1,pointBackgroundColor:"rgba(55, 179, 142, 1)",pointBorderColor:"rgba(55, 179, 142, 1)",pointHoverBackgroundColor:"rgba(55, 179, 142, 1)",pointHoverBorderColor:"rgba(55, 179, 142, 1)"},{label:e.data.avgDonation?e.data.avgDonation:0,data:e.data.donationAvg?e.data.donationAvg:0,backgroundColor:"rgba(216, 225, 180, 1)",borderColor:"rgba(251, 214, 20, 0.90)",lineTension:"0",borderWidth:"2",pointRadius:1,pointBackgroundColor:"rgba(251, 214, 20, 0.90)",pointBorderColor:"rgba(251, 214, 20, 0.90)",pointHoverBackgroundColor:"rgba(251, 214, 20, 0.90)",pointHoverBorderColor:"rgba(251, 214, 20, 0.90)"}]}})}))})).change()},campaignImgPopup:function(){techjoomla.jQuery(".popup-gallery").magnificPopup({delegate:"a",type:"image",tLoading:"Loading image #%curr%...",mainClass:"mfp-img-mobile",gallery:{enabled:!0,navigateByImgClick:!0,preload:[0,1]},image:{tError:'<a href="%url%">The image #%curr%</a> could not be loaded.',titleSrc:function(e){return e.el.attr("title")+"<small></small>"}}})},onChangefun:function(){jQuery("#gallary_filter").change((function(){var e=document.getElementById("gallary_filter").value;"1"==e?(jQuery("#videos").show(),jQuery("#images").hide(),jQuery(".videosText").show(),jQuery(".imagesText").hide()):"2"==e?(jQuery("#videos").hide(),jQuery("#images").show(),jQuery(".imagesText").show(),jQuery(".videosText").hide()):"0"==e&&(jQuery("#videos").show(),jQuery("#images").show(),jQuery(".videosText").show(),jQuery(".imagesText").show())})).change()},loadActivity:function(){techjoomla.jQuery(window).load((function(){"1"==techjoomla.jQuery("#camp_activity .feed-item-cover").length&&techjoomla.jQuery(".todays-activity .feed-item").css("border-left","0px"),techjoomla.jQuery("#postactivity").attr("disabled",!0),techjoomla.jQuery("#activity-post-text").on("input",(function(){""==techjoomla.jQuery("#activity-post-text").val()?techjoomla.jQuery("#postactivity").attr("disabled",!0):techjoomla.jQuery("#postactivity").attr("disabled",!1);var e=techjoomla.jQuery("#activity-post-text").attr("maxlength")-techjoomla.jQuery("#activity-post-text").val().length;techjoomla.jQuery("#activity-post-text-length").html(e+" "+Joomla.Text._("COM_JGIVE_POST_TEXT_ACTIVITY_REMAINING_TEXT_LIMIT"))}))}))},playVideo:function(e){var t=jQuery(window).width(),a=jQuery(window).height(),o=t-.1*t,i=a-.1*a;if("undefined"==typeof SqueezeBox){var r=null!=window.screenLeft?window.screenLeft:screen.left,n=null!=window.screenTop?window.screenTop:screen.top,l=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,s="width="+o+",height="+i+",top="+((window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height)/2-i/2+n)+",left="+(l/2-o/2+r);window.open(e,"",s)}else SqueezeBox.open(e,{handler:"iframe",size:{x:o,y:i},classWindow:"tjlms-modal"})}},campaign:{init:function(){jQuery("#jform_goal_amount").change((function(){jgiveCommon.validateAmountAsPerCurrency(this)})),jQuery(document).ready((function(){jQuery(window).width()<767&&(jQuery("#launchForm__nav").removeClass("d-flex"),jQuery("#launchForm__nav").addClass("panel-group"),jQuery("#launchForm__nav a").attr("data-toggle","collapse")),jQuery(document).ready((function(){jgiveCommon.lifetimeCampaign()})),jQuery.each(mediaGallery,(function(e,t){tjMediaFile.previewFile(t,1,"")})),jQuery("#jform_amount_suggestions_tags").on("beforeItemAdd",(function(e){const[t,a]=jgiveCommon.campaignForm.validateAmountSuggestion(e.item);t&&(alert(a),e.cancel=t)}))}))},searchCampDonors:function(){var e=document.getElementById("SearchDonorsinputbox");"inline"==e.style.display?e.style.display="none":e.style.display="inline",jQuery(".fa-search").toggleClass("btn btn-primary btn-sm p-10")},searchDonor:function(){var e,t,a,o,i;e=document.getElementById("donorInput");var r=document.getElementById("noDataFoundDiv");t=e.value.toUpperCase(),a=document.getElementById("singlecampaignDonor").getElementsByTagName("tr");let n=0;for(i=0;i<a.length;i++)(o=a[i].getElementsByTagName("td")[0])&&(o.innerHTML.toUpperCase().indexOf(t)>-1?(jQuery("#btn_showMorePic").show(),a[i].style.display="",n=1):(jQuery("#btn_showMorePic").hide(),a[i].style.display="none"));r.style.display="block",n&&(r.style.display="none")},showMoreDonors:function(){var e=document.getElementById("camp_id").value,t=techjoomla.jQuery("#jgiveWrapper");t.addClass("isloading"),0==gbl_jgive_pro_pic&&(gbl_jgive_pro_pic=document.getElementById("donors_pro_pic_index").value),techjoomla.jQuery.ajax({url:jgive_baseurl+"index.php?option=com_jgive&format=json&task=campaign.showMoreDonors&tmpl=component",type:"POST",dataType:"json",data:{cid:e,jgive_index:gbl_jgive_pro_pic},success:function(e){gbl_jgive_pro_pic=e.jgive_index,techjoomla.jQuery("#jgive_donors_pic ").append(e.records),(!e.records||orders_count<=gbl_jgive_pro_pic)&&techjoomla.jQuery("#btn_showMorePic").hide(),t.removeClass("isloading")},error:function(e){console.log("error")}})},featuredCamp:function(e,t){if(1==e)var a=0;else a=1;techjoomla.jQuery.ajax({url:"?option=com_jgive&task=campaign.changeCampFeatureStatus&tmpl=component",type:"POST",dataType:"json",data:{cid:t,featured:a},success:function(e){1==e&&window.location.reload()},error:function(e){console.log("error")}})},getJSGroupField:function(){if("jomsocial"===integration){var e=document.getElementById("jform_creator_id_id").value,t={};t.user=e,jQuery("#jform_js_groupid, .chzn-results").empty(),JSON.stringify(t),jQuery.ajax({type:"POST",data:t,dataType:"json",url:Joomla.getOptions("system.paths").baseFull+"index.php?option=com_jgive&format=json&task=campaignform.getJSGroups",success:function(e){if(jQuery("#jform_js_groupid").trigger("liszt:updated"),jQuery("#jform_js_groupid").trigger("chosen:updated"),""==e.data){var t="<option value='0' selected='selected'>"+Joomla.Text._("COM_JGIVE_NO_JS_GROUPS")+"</option>";jQuery("#jform_js_groupid").append(t),jQuery("#jform_js_groupid").trigger("liszt:updated"),jQuery("#jform_js_groupid").trigger("chosen:updated")}else for(var a=0;a<e.data.length;++a){var o="";jsGroupId===e.data[a].id?(o="selected",t="<option value='"+e.data[a].id+"' selected='"+o+"' > "+e.data[a].title+"</option>"):t="<option value='"+e.data[a].id+"'> "+e.data[a].title+"</option>",jQuery("#jform_js_groupid").append(t),jQuery("#jform_js_groupid").trigger("liszt:updated"),jQuery("#jform_js_groupid").trigger("chosen:updated")}}})}}},report:{showMoreReports:function(){let e=parseInt(jQuery("#campaign_id").val()),t=parseInt(jQuery("#limit_offset").val());techjoomla.jQuery.ajax({url:jgive_baseurl+"index.php?option=com_jgive&task=reports.showMoreReports",type:"POST",dataType:"json",data:{campaign_id:e,limit_offset:t},success:function(e){let a=t+5;techjoomla.jQuery("#limit_offset").val(a),techjoomla.jQuery("#reports_list").append(e.data.layout),e.data.count<=a&&techjoomla.jQuery("#btn_showMorePic").hide()},error:function(e){console.log(e)}})},delete:function(e,t,a){if(1!=confirm(Joomla.Text._("COM_JGIVE_CONFIRM_DELETE_REPORT")))return!1;{let o=jQuery(t).attr("data-cid"),i=jQuery(t).attr("data-rid");window.location=jgive_baseurl+"index.php?option=com_jgive&task="+e+"&"+a+"=1&cid="+o+"&id="+i}},deleteReportAttachment:function(e,t,a){if(1!=confirm(Joomla.Text._("COM_JGIVE_CONFIRM_DELETE_REPORT_ATTACHMENT")))return!1;{let i=jQuery(t).attr("data-cid"),r=jQuery(t).attr("data-rid"),n=jQuery(t).attr("data-mid");var o=jgive_baseurl+"index.php?option=com_jgive&format=json&task="+e+"&cid="+i+"&id="+r+"&mid="+n+"&"+a+"=1";jQuery.ajax({url:o,type:"GET",dataType:"JSON",success:function(e){let t=e.message;!0===e.success?(Joomla.renderMessages({success:[t]}),jQuery("html, body").animate({scrollTop:0},500)):(Joomla.renderMessages({error:[t]}),jQuery("html, body").animate({scrollTop:0},500)),setTimeout((function(){window.location.reload(1)}),600)}})}},addAttachment:function(){if(currentAttachmentCount=attachmentMaxLimit-reportAttachmentCount-uploadFileDivId,!(currentAttachmentCount>0)){let e=Joomla.Text._("COM_JGIVE_REACHED_MAX_REPORT_ATTACHMENT_LIMIT");return Joomla.renderMessages({error:[e]}),jQuery("html, body").animate({scrollTop:0},500),!1}{uploadFileDivId++;let e=techjoomla.jQuery("#jgiveWrapper .jgreports__attachemts-clone-div .jgreports__attachemts-clone").clone(!1);e.find("#jform_attachments").attr("id","jform_attachments"+uploadFileDivId),e.find("#jform_attachmentsvalue").attr("id","jform_attachments"+uploadFileDivId+"value"),e.find("#jform_removeAttachment").attr("id","jform_removeAttachment"+uploadFileDivId),jQuery(".jgreports__attachemts").append(e)}},removeAttachment:function(e,t,a,o){let i=e.id.charAt(e.id.length-1),r=jQuery("#jform_attachments"+i+"value").val();if(r){let i=Joomla.getOptions("system.paths").baseFull+"index.php?option=com_jgive&format=json&task=campaignform.deleteMedia&"+t+"=1";if(!confirm(Joomla.Text._("COM_JGIVE_CONFIRM_DELETE_MEDIA")))return!1;jQuery.ajax({type:"POST",url:i,dataType:"JSON",data:{id:r,client:a,clientId:o},success:function(t){jQuery(e).parents(".jgreports__attachemts-clone").remove(),uploadFileDivId--}})}else jQuery(e).parents(".jgreports__attachemts-clone").remove(),uploadFileDivId--},validateFile:function(e,t){if("file"!=jQuery(e).attr("type"))return!1;jQuery("#system-message-container").empty();let a=jQuery(e)[0].files[0],o=(a.type.split("/"),a.name.split(".")),i=allowedAttachments.split(","),r=0,n=new Array;if(""!==o[o.length-1]||null!==o[o.length-1]){if(-1==jQuery.inArray(o[o.length-1],i)&&(r="1",n.push(Joomla.Text._("COM_JGIVE_FILE_TYPE_ERROR"))),!r){var l,s=jgive_baseurl+"index.php?option=com_jgive&format=json&task=reportform.checkMimeType";jQuery.ajax({url:s,type:"POST",dataType:"JSON",async:!1,data:{fileExtension:o[o.length-1]},success:function(e){l=e}}),(null===l&&""===l||a.type!==l)&&(r="1",n.push(Joomla.Text._("COM_JGIVE_FILE_TYPE_ERROR")))}}else r="1",n.push(Joomla.Text._("COM_JGIVE_FILE_TYPE_ERROR"));if(a.size>1024*attachmentMaxSize*1024&&(r="1",n.push(Joomla.Text._("COM_JGIVE_FILE_SIZE_ERROR"))),r)return jQuery(e)[0].value="",Joomla.renderMessages({error:n}),jQuery("html, body").animate({scrollTop:0},500),!1;jgive.report.uploadFile(e,t)},uploadFile:function(e,t){let a=new FormData;const o=jQuery("#reportFormtoken input").attr("name");let i=jQuery(e)[0].files[0];a.append("file",i),a.append("isGallary",t),a.append(o,1);var r=jgive_baseurl+"index.php?option=com_jgive&format=json&task=reportform.uploadFile";this.ajaxObj=jQuery.ajax({type:"POST",url:r,dataType:"JSON",contentType:!1,processData:!1,data:a,xhr:function(){var t=jQuery.ajaxSettings.xhr();return t.upload&&t.upload.addEventListener("progress",(function(t){if(t.lengthComputable){var a=Math.floor(t.loaded/t.total*100);jgive.report.progressBar.updateStatus(e.id,a)}}),!1),t},beforeSend:function(t){jgive.report.progressBar.init(e.id,"")},success:function(t){t.data.mediaId?(jQuery("#"+e.id+"value").val(t.data.mediaId),jgive.report.progressBar.statusMsg(e.id,"success",t.message)):(jQuery(e).val(""),jQuery("#"+e.id).siblings(".progress").remove(),jgive.report.progressBar.statusMsg(e.id,"error",t.message))},error:function(t,a,o){jgive.report.progressBar.statusMsg(e.id,"error",Joomla.Text._("COM_JGIVE_FILE_ERROR"))}})},progressBar:{init:function(e,t){jQuery("#"+e).siblings(".alert").remove(),jQuery("#"+e).siblings(".progress").remove(),this.progress=jQuery("<div class='progress progress-striped active' style='height:24px'><div class='bar' style='width:0%;background-color:#4CAF50;'></div><button onclick='return tjexport.abort();' class='btn btn-danger btn-small pull-right'>"+Joomla.Text._("COM_JGIVE_FILE_UPLOAD_ABORT")+"</button></div>"),this.statusBar=this.progress.find(".bar"),this.abort=jQuery("<div class='abort'><span>"+Joomla.Text._("COM_JGIVE_FILE_UPLOAD_ABORT")+"</span></div>").appendTo(this.statusbar),jQuery("#"+e).after(this.progress)},updateStatus:function(e,t){this.statusBar.css("width",t+"%"),this.statusBar.width(t+"%"),this.statusBar.text(t+"%")},abort:function(){if(!confirm(Joomla.Text._("COM_JGIVE_FILE_UPLOAD_CONFIRM_ABORT")))return!1;this.ajaxObj.abort()},statusMsg:function(e,t,a){setTimeout((function(){jQuery("#"+e).siblings(".progress").remove()}),2e3);let o="<a href='#' class='close pull-right' data-dismiss='alert' aria-label='close' title='"+Joomla.Text._("COM_JGIVE_FILE_UPLOAD_ABORT")+"'>×</a>",i=jQuery("<br><br><div class='alert alert-"+t+"'><strong>"+a+"</strong>"+o+"</div>");jQuery("#"+e).parent().after(i)}}},dashboard:{init:function(){techjoomla.jQuery(document).ready((function(){0==localStorage.getItem("filter")&&jQuery(".search__campaign").toggleClass("af-d-none active"),jgive.dashboard.onChangeGetDashboardDonationData()}))},onChangeGetDashboardDonationData:function(){techjoomla.jQuery("#dashboardcampaignsOption").change((function(){var e=document.getElementById("dashboardcampaignsOption").value,t=document.getElementById("user_id").value;techjoomla.jQuery.ajax({type:"GET",url:jgive_baseurl+"index.php?option=com_jgive&view=dashboard&task=dashboard.getDashboardGraphData&userId="+t+"&filtervalue="+e,dataType:"json",sucess:function(e){},error:function(e){console.log("error")}}).done((function(e){var t=document.getElementById("dashboardCampaign_graph").getContext("2d");new Chart(t,{type:"line",data:{labels:e.donationDate,datasets:[{label:e.totalDonation?e.totalDonation:0,data:e.donationAmount?e.donationAmount:0,backgroundColor:"rgba(203, 235, 230, 0.5)",borderColor:"rgba(55, 179, 142, 1)",lineTension:"0",borderWidth:"2",pointRadius:1,pointBackgroundColor:"rgba(55, 179, 142, 1)",pointBorderColor:"rgba(55, 179, 142, 1)",pointHoverBackgroundColor:"rgba(55, 179, 142, 1)",pointHoverBorderColor:"rgba(55, 179, 142, 1)"},{label:e.avgDonation?e.avgDonation:0,data:e.donationAvg?e.donationAvg:0,backgroundColor:"rgba(216, 225, 180, 1)",borderColor:"rgba(251, 214, 20, 0.90)",lineTension:"0",borderWidth:"2",pointRadius:1,pointBackgroundColor:"rgba(251, 214, 20, 0.90)",pointBorderColor:"rgba(251, 214, 20, 0.90)",pointHoverBackgroundColor:"rgba(251, 214, 20, 0.90)",pointHoverBorderColor:"rgba(251, 214, 20, 0.90)"}]}})}))})).change()},toggleDiv:function(e){jQuery(window).width()<767&&jQuery("#"+e).toggle(),jQuery(".campaigns__filter").toggleClass("af-d-none active"),"SearchFilterInputBox"==e&&(jQuery(".search__campaign").toggleClass("active af-d-none"),jQuery(".fa-search").toggleClass("btn btn-primary btn-sm p-10"),jQuery(".campaign__filter").toggleClass("af-d-none"),jQuery(".list__separation").toggleClass("af-d-none"))},clearFilter:function(){window.location=window.location.href}},campaigns:{campaignSearch:function(){var e=document.getElementById("filter_search").value,t=jgive_baseurl+"index.php?option=com_jgive&view=campaigns&layout=all&filter_search="+e+"&Itemid="+menuItemId;window.location.assign(t)},campaignSearchClear:function(){localStorage.setItem("filter",1),document.getElementById("filter_search").value="",jgiveCommon.filters.submitFilters("adminForm4")},myCampaignFilterCampType:function(){var e=document.getElementById("filter_campaign_type").value,t=jgive_baseurl+"index.php?option=com_jgive&view=campaigns&layout=my&filter_campaign_type="+e+"&Itemid="+menuItemId;window.location.assign(t)},myCampaignCategoryFilter:function(){var e=document.getElementById("filter_campaign_cat").value,t=jgive_baseurl+"index.php?option=com_jgive&view=campaigns&layout=my&filter_campaign_cat="+e+"&Itemid="+menuItemId;window.location.assign(t)},myCampaignOrgIndTypeFilter:function(){var e=document.getElementById("filter_org_ind_type").value,t=jgive_baseurl+"index.php?option=com_jgive&view=campaigns&layout=my&filter_org_ind_type="+e+"&Itemid="+menuItemId;window.location.assign(t)}},donation:{retryPayment:function(e){let t=jQuery("input[name='gateways']:checked"),a=t.val(),o=t.attr("data-single-gateway");o=0,void 0!==o&&"1"==o&&(o=1);let i=jgive_baseurl+"index.php?option=com_jgive&tmpl=component&task=donations.retryPayment&order="+e+"&gateway_name="+a+"&single_gateway="+o;jQuery("#html-container").empty().html(Joomla.Text._("COM_JGIVE_LOADER_LOADING")),jQuery.ajax({url:i,type:"GET",dataType:"json",beforeSend:function(){jQuery("html, body").animate({scrollTop:jQuery("#html-container").offset().top},1e3)},success:function(e){jQuery("#html-container").removeClass("ajax-loading").html(e)}})},showPaymentGetways:function(e,t){return 1===jQuery("#jgiveWrapper #gatewaysContent div.radio").length&&(jQuery("#jgiveWrapper #gatewaysContent .form-group").hide(),jQuery("#jgiveWrapper #gatewaysContent .form-group input:first-child").attr("data-single-gateway","1"),jQuery("#jgiveWrapper #gatewaysContent .form-group input:first-child").click()),"none"==document.getElementById("gatewaysContent").style.display&&("1"==e?alert(t):"0"==e&&(document.getElementById("gatewaysContent").style.display="block")),!1}},donations:{init:function(){techjoomla.jQuery(document).ready((function(){com_jgive.UI.Donation.updatePlatformFee(document.getElementById("donation_amount"),cid),"yes"==allowPanVerification?panAmountLimit>0&&(parseInt(jQuery("#donation_amount").val())<panAmountLimit?(jQuery(".pan").addClass("d-none"),jQuery("#pannumber").removeClass("required")):(jQuery(".pan").removeClass("d-none"),jQuery("#pannumber").addClass("required"))):(jQuery(".pan").addClass("d-none"),jQuery("#pannumber").removeClass("required"))}))},validatePANFields:function(){var e=techjoomla.jQuery("#pannumber").val();if(null!==e){let t=/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/;return e.match(t)?(jgiveCommon.getPanVerification(e),!0):(alert(Joomla.Text._("COM_JGIVE_PAN_VERIFICATION_VALIDATION_ERROR")),jQuery("#pannumber").val(""),!1)}},populateSelected_GivebackAmount:function(e,t){e?(techjoomla.jQuery("#jgive_givebacks ul .jgive_active").removeClass("jgive_active"),techjoomla.jQuery(t).closest("li").addClass("jgive_active"),techjoomla.jQuery("#donation_amount").attr("value",e),com_jgive.UI.Donation.updatePlatformFee(document.getElementById("donation_amount"),cid)):(techjoomla.jQuery("#donation_amount").attr("value",0),com_jgive.UI.Donation.updatePlatformFee(document.getElementById("donation_amount"),cid))},placeQuickPayment:function(){var e=techjoomla.jQuery("#payment_quick").serialize();techjoomla.jQuery("#payment_quick").serializeArray()[0].value;if(!1===jgiveCommon.validateAmountAsPerCurrency(jQuery("#donation_amount")))return!1;techjoomla.jQuery("#order_id").val();var t=0;return 0!=donationTermsCondition&&0!=donationTermsConditionArticle&&!1===document.payment_quick.terms_condition.checked?(alert(Joomla.Text._("COM_JGIVE_CHECK_TERMS")),!1):(techjoomla.jQuery("#jgive_form_field .required").each((function(){if(!techjoomla.jQuery(this).val())return techjoomla.jQuery(this).focus(),alert(Joomla.Text._("COM_JGIVE_FILL_MANDATORY_FIELDS_DATA")),t=1,!1})),techjoomla.jQuery("#payment_quick input[name='gateways']").length&&techjoomla.jQuery("#payment_quick input[name='gateways']:checked").length<1?(techjoomla.jQuery("#payment_quick #jgive_footer").focus(),alert(Joomla.Text._("COM_JGIVE_DONATION_VALIDATION_WRONG_PAYMENT_METHOD")),t=1,!1):1!==t&&(jgive.donations.validateEmail(document.getElementById("paypal_email").value)?!!jgive.donations.donationAmountValidation()&&void techjoomla.jQuery.ajax({url:jgive_baseurl+"index.php?option=com_jgive&task=donations.placeOrder&tmpl=component",type:"POST",dataType:"json",async:!0,data:e,beforeSend:function(){jgive.donations.requestProcessingImg(),techjoomla.jQuery("#jgive_form_field").addClass("jgive-blur-fields"),techjoomla.jQuery("#jgive_givebacks").addClass("jgive-blur-fields"),techjoomla.jQuery("#jgive_disabled_fields input").each((function(){techjoomla.jQuery(this).attr("readonly","readonly"),techjoomla.jQuery("#payment_quick input:radio").attr("disabled",!0)})),techjoomla.jQuery("input:radio[name=givebacks]").attr("readonly","readonly"),techjoomla.jQuery("#jgive_edit_button").removeClass("jgive_edit_button")},complete:function(e){jgive.donations.hiderequestProcessingImg()},success:function(e){if(jgive.donations.hiderequestProcessingImg(),1==e.success)techjoomla.jQuery("#jgive_continue_btn").hide(),techjoomla.jQuery("#payment_tab_table_html").html(e.payhtml),techjoomla.jQuery("#payment_tab_table_html").html(e.gatewayhtml),techjoomla.jQuery("#payment_tab_table_html").show(),techjoomla.jQuery("html,body").animate({scrollTop:techjoomla.jQuery("#payment_tab_table_html").offset().top},"slow");else{if(e.success_msg.length>0)for(x of e.success_msg)Joomla.renderMessages({error:[x]}),jQuery("html, body").animate({scrollTop:0},500);techjoomla.jQuery("#jgive_continue_btn").show()}},error:function(){alert(Joomla.Text._("COM_JGIVE_ORDER_PLACING_ERROR")),techjoomla.jQuery("#jgive_continue_btn").show(),jgive.donations.hiderequestProcessingImg()}}):(techjoomla.jQuery("#paypal_email").focus(),!1)))},requestProcessingImg:function(){if(jQuery("#jgiveWrapper .tjBs5").length)techjoomla.jQuery('<div id="jgive_processing"></div>').css({background:"rgba(255, 255, 255, 0.8) url('"+jgive_baseurl+"media/com_jgive/images/ajax.gif') 50% 15% no-repeat",top:techjoomla.jQuery("#jgive_content").position().top,left:techjoomla.jQuery("#jgive_content").position().left,width:techjoomla.jQuery("#jgive_content").outerWidth(),height:techjoomla.jQuery("#jgive_content").outerHeight(),position:"absolute","z-index":"1000",opacity:"0.80"}).appendTo("#jgive_content"),techjoomla.jQuery("#jgive_processing").show();else{techjoomla.jQuery("#jgive_content").width(),techjoomla.jQuery("#jgive_content").height();techjoomla.jQuery('<div id="jgive_processing"></div>').css("background","rgba(255, 255, 255, .8) url('"+jgive_baseurl+"media/com_jgive/images/ajax.gif') 50% 15% no-repeat").css("top",techjoomla.jQuery("#jgive_content").position().top-techjoomla.jQuery("#jgive_content").scrollTop()).css("left",techjoomla.jQuery("#jgive_content").position().left-techjoomla.jQuery("#jgive_content").scrollLeft()).css("width","100%").css("height","100%").css("position","fixed").css("z-index","1000").css("opacity","0.80").css("-ms-filter","progid:DXImageTransform.Microsoft.Alpha(Opacity = 80)").css("filter","alpha(opacity = 80)").appendTo("#jgive_content")}},hiderequestProcessingImg:function(){techjoomla.jQuery("#jgive_processing").remove()},donationAmountValidation:function(){var e=document.getElementById("donation_amount").value;return(e=parseFloat(e))?(total_commission_amount=0,send_payments_to_owner||(total_commission_amount=fixed_commissionfee,commission_fee&&(total_commission_amount=e*commission_fee/100+fixed_commissionfee)),total_commission_amount<minimum_amount&&(total_commission_amount=minimum_amount),total_commission_amount>e?(alert(Joomla.Text._("COM_JGIVE_MINIMUM_DONATION_AMOUNT")+minimum_amount),!1):!!jgive.donations.validateGiveBackAmount(e)):(alert(Joomla.Text._("COM_JGIVE_MINIMUM_DONATION_AMOUNT")+minimum_amount),!1)},validateGiveBackAmount:function(e){var t=techjoomla.jQuery("input:radio[name=givebacks]:checked").val();if(0!=t)for(var a=0;a<givebackDetails.length;a++)if(givebackDetails[a].id==t){var o=givebackDetails[a].amount;return e>=o||(alert(Joomla.Text._("COM_JGIVE_AMOUNT_SHOULD_BE")+o),!1)}return!0},validateEmail:function(e){return!!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(e)||(alert(Joomla.Text._("COM_JGIVE_EMAIL_VALIDATION")),!1)},editDetails:function(){techjoomla.jQuery("#payment_tab_table_html").html(""),techjoomla.jQuery("#payment_tab_table_html").hide(),techjoomla.jQuery("#jgive_disabled_fields input").each((function(){techjoomla.jQuery(this).removeAttr("readonly"),techjoomla.jQuery("#payment_quick input:radio").attr("disabled",!1)})),techjoomla.jQuery("input:radio[name=givebacks]").removeAttr("readonly"),techjoomla.jQuery("#jgive_form_field").removeClass("jgive-blur-fields"),techjoomla.jQuery("#jgive_givebacks").removeClass("jgive-blur-fields"),techjoomla.jQuery("#jgive_edit_button").addClass("jgive_edit_button"),techjoomla.jQuery("#jgive_continue_btn").show()},validateCheckoutFields:function(){var e=techjoomla.jQuery("#paypal_email").val();if(null!==e){let a=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/;if(e.match(a))return!0;var t={error:[]};return t.error.push(Joomla.Text._("COM_JGIVE_EMAIL_VALIDATION")),Joomla.renderMessages(t),techjoomla.jQuery("#paypal_email").focus(),!1}},validateAmount:function(e,t){switch(e){case"max_donors":case"minimum_amount":if(""!==techjoomla.jQuery("#"+e).val()&&!parseInt(techjoomla.jQuery("#"+e).val(),10)>1)return alert(t),techjoomla.jQuery("#"+e).val(""),techjoomla.jQuery("#"+e).focus(),!1;if(""!==techjoomla.jQuery("#"+e).val()&&techjoomla.jQuery("#"+e).val()<0)return alert(t),techjoomla.jQuery("#"+e).val(""),techjoomla.jQuery("#"+e).focus(),!1;break;case"recurring_count":if(""!==techjoomla.jQuery("#"+e).val()&&!parseInt(techjoomla.jQuery("#"+e).val(),10)>2)return alert(t),techjoomla.jQuery("#"+e).val(""),techjoomla.jQuery("#"+e).focus(),!1;if(""!==techjoomla.jQuery("#"+e).val()&&techjoomla.jQuery("#"+e).val()<2)return alert(t),techjoomla.jQuery("#"+e).val(""),techjoomla.jQuery("#"+e).focus(),!1;break;default:var a=".";"."==decimal_separator&&(a=",");var o=techjoomla.jQuery("#"+e).val().replace(a,"");if(techjoomla.jQuery("#"+e).val(o),""!==techjoomla.jQuery("#"+e).val()&&!parseInt(techjoomla.jQuery("#"+e).val(),10)>0)return alert(t),techjoomla.jQuery("#"+e).val(""),techjoomla.jQuery("#"+e).focus(),!1;if(""!==techjoomla.jQuery("#"+e).val()&&techjoomla.jQuery("#"+e).val()<0)return alert(t),techjoomla.jQuery("#"+e).val(""),techjoomla.jQuery("#"+e).focus(),!1}},noGiveBack:function(){null==techjoomla.jQuery("input:checkbox[name=no_giveback]:checked").val()?(techjoomla.jQuery("#hide_giveback").show("slow"),techjoomla.jQuery("#hide_giveback_desc").show("slow")):(techjoomla.jQuery("#hide_giveback").hide("slow"),techjoomla.jQuery("#hide_giveback_desc").hide("slow"))},populateGiveback:function(){var e=techjoomla.jQuery("#givebacks").val(),t=techjoomla.jQuery("#cid").val();"edit_amount"==e&&(techjoomla.jQuery("#giveback_des").html(Joomla.Text._("COM_JGIVE_GIVE_NOT_AVIL_FOR_THIS_AMOUNT")),techjoomla.jQuery("#hide_giveback_desc").removeClass("d-none")),0==e&&(techjoomla.jQuery("#donation_amount").attr("value",minimum_amount),techjoomla.jQuery("#hide_giveback_desc").addClass("d-none"),com_jgive.UI.Donation.updatePlatformFee(document.getElementById("donation_amount"),t));for(var a=0;a<givebackDetails.length;a++)givebackDetails[a].id==e&&(techjoomla.jQuery("#donation_amount").attr("value",parseFloat(givebackDetails[a].amount)),techjoomla.jQuery("#giveback_des").html(Joomla.Text._("COM_JGIVE_GIVEBACK_DESC")+" : "+givebackDetails[a].description),techjoomla.jQuery("#hide_giveback_desc").removeClass("d-none"),com_jgive.UI.Donation.updatePlatformFee(document.getElementById("donation_amount"),t))},otherCity:function(){!0===document.jGivePaymentForm.other_city_check.checked?(jQuery("#other_city").show("slow"),jQuery("#hide_city").parent().parent().hide("slow"),jQuery("#other_city_check").appendTo("#other_city_lbl"),jQuery("#other_city_check").css("min-height","0px"),jQuery("#jgiveWrapper .tjBs5").length&&(jQuery("#other_city_control").removeClass("form-check"),jQuery("#other_city_check").addClass("mt-1"))):(jQuery("#other_city_check").prependTo("#other_city_control"),jQuery("#jgiveWrapper .tjBs5").length||jQuery("#other_city_check").css("min-height","34px"),jQuery("#hide_city").parent().parent().show("slow"),jQuery("#other_city").val(""),jQuery("#other_city").hide("slow"),jQuery("#jgiveWrapper .tjBs5").length&&(jQuery("#other_city_control").addClass("form-check"),jQuery("#other_city_check").removeClass("mt-1")))},jgive_toggleOrder:function(e){techjoomla.jQuery("#"+e).toggle()},jgive_hideshowTabs:function(e){jgive.donations.jgive_hideAllEditLinks(),techjoomla.jQuery(".checkout-content").slideUp("slow"),techjoomla.jQuery(e).hide(),techjoomla.jQuery("#payment_tab_table_html").html(),techjoomla.jQuery(e).parent().parent().find(".checkout-content").slideDown("slow")},jgive_hideAllEditLinks:function(){techjoomla.jQuery(".jgive_editTab").hide()},jgive_showAllEditLinks:function(){techjoomla.jQuery(".jgive_editTab").show()},goToByScroll:function(e){techjoomla.jQuery("html,body").animate({scrollTop:techjoomla.jQuery("#"+e).offset().top},"slow")},addEditLink:function(e,t){techjoomla.jQuery("#"+t.toString()+" .checkout-heading .badge").remove(),techjoomla.jQuery(e).append('<span class=" badge badge-success pull-right" id="jgive_success_icon"><i class="fa fa-check"></i></span><a class="jgive_editTab" onclick="jgive.donations.jgive_hideshowTabs(this)">'+Joomla.Text._("COM_JGIVE_EDIT")+" &nbsp;&nbsp;</a>")},chkmail:function(e){techjoomla.jQuery.ajax({url:"?option=com_jgive&task=donations.chkmail&email="+e+"&tmpl=component",type:"GET",dataType:"json",success:function(e){1==e[0]?(alert(e[1]),techjoomla.jQuery("#button-billing-info").attr("disabled","disabled")):(techjoomla.jQuery("#email_reg").html(""),techjoomla.jQuery("#button-billing-info").removeAttr("disabled"))}})},paymentFormValidateGiveBackAmount:function(e){var t=techjoomla.jQuery("input:checkbox[name=no_giveback]:checked").val(),a=techjoomla.jQuery("#givebacks").val();if(null==t)for(index=0;index<givebackDetails.length;index++)if(givebackDetails[index].id==a){var o=givebackDetails[index].amount;return e>=o||("donation"===campaign_type?alert(Joomla.Text._("COM_JGIVE_DONATION_AMOUNT_SHOULD_BE")+o+currency_symbol):alert(Joomla.Text._("COM_JGIVE_INVESTMENT_AMOUNT_SHOULD_BE")+o+currency_symbol),!1)}return!0},jgive_login:function(){techjoomla.jQuery.ajax({url:jgive_baseurl+"?option=com_jgive&task=donations.login_validate",type:"post",data:techjoomla.jQuery("#user-info-tab #login :input"),dataType:"json",beforeSend:function(){techjoomla.jQuery("#button-login").attr("disabled",!0),techjoomla.jQuery("#button-login").after('<span class="wait">&nbsp;Loading..</span>')},complete:function(){techjoomla.jQuery("#button-login").attr("disabled",!1),techjoomla.jQuery(".wait").remove()},success:function(e){techjoomla.jQuery(".warning, .j2error").remove(),e.error?(techjoomla.jQuery("#login").prepend('<div class="warning alert alert-danger" >'+e.error.warning+'<button data-dismiss="alert" class="close" type="button">×</button></div>'),techjoomla.jQuery(".warning").fadeIn("slow")):e.redirect&&(location=e.redirect)},error:function(){alert(Joomla.Text._("COM_JGIVE_CHECKOUT_ERROR_LOGIN"))}})},useSuggestedAmount:function(e,t){techjoomla.jQuery("#donation_amount").val(e),jQuery(".amount-suggestions .item-amount-suggestion").each((function(){jQuery(this).removeClass("active")})),jQuery(t).addClass("active")}},individualform:{init:function(){jQuery(document).ready((function(){com_jgive.UI.Individual.hideUserCheckbox(user_id)})),Joomla.submitbutton=function(e){"individualform.save"==e?1==document.formvalidator.isValid(document.getElementById("adminForm"))&&Joomla.submitform(e,document.getElementById("adminForm")):Joomla.submitform(e,document.getElementById("adminForm"))}}},organizationform:{init:function(){techjoomla.jQuery(document).ready((function(){com_jgive.UI.Organization.contact(0,"jform_vendor_id"),com_jgive.UI.Organization.otherCity(other_city_check,other_city_value),com_jgive.UI.Common.generateStates("jform_country",1,region,city)}))}},individuals:{individualsSubmit:function(e){if("individuals.delete"==e&&!0!==confirm(Joomla.Text._("COM_JGIVE_ARE_YOU_SURE_YOU_TO_DELETE_THE_CONTACTS")))return;Joomla.submitform(e)}}},jgiveAdmin={campaign:{init:function(){jQuery("#jform_goal_amount").change((function(){jgiveCommon.validateAmountAsPerCurrency(this)})),Joomla.submitbutton=function(e){if(""==e)return!1;var t=!0,a=e.split(".");if("cancel"!=a[1]&&"close"!=a[1]||Joomla.submitform(e),"cancel"!=a[1]&&"close"!=a[1]){for(var o=jQuery("form.form-validate"),i=0;i<o.length;i++)if(!document.formvalidator.isValid(o[i])){t=!1;break}const e=jQuery("#jform_amount_suggestions_tags").val().trim();if(""!==e){const a=e.split(",");for(i=0;i<a.length;i++){const[e,o]=jgiveCommon.campaignForm.validateAmountSuggestion(a[i]);if(e){alert(o),t=!1;break}}}}return!!t&&(jgiveCommon.campaignForm.save(e),!0)},jQuery(document).ready((function(){jgiveCommon.lifetimeCampaign()})),jQuery(document).ready((function(){jQuery("#jform_id").val();jQuery.each(mediaGallery,(function(e,t){tjMediaFile.previewFile(t,1,"")})),jgive.campaign.getJSGroupField(),jQuery("#jform_amount_suggestions_tags").on("beforeItemAdd",(function(e){const[t,a]=jgiveCommon.campaignForm.validateAmountSuggestion(e.item);t&&(alert(a),e.cancel=t)}))}))}},donations:{getGiveBackAgainstCampaign:function(e){techjoomla.jQuery(document).ready((function(){techjoomla.jQuery("#givebacks").find("option").remove().end(),techjoomla.jQuery.ajax({url:"index.php?option=com_jgive&task=donations.getGiveBackAgainstCampaign&tmpl=component",type:"POST",dataType:"json",data:{cid:e},success:function(e){var t=0,a=0,o="<option value='0' >"+Joomla.Text._("COM_JGIVE_GIVEBACKS_TOOLTIP")+"</option>";techjoomla.jQuery("#givebacks").append(o);for(var i=0;i<e.length;i++)if(0==e[i].sold_out){o="<option value="+e[i].id+" >"+e[i].title+"</option>";techjoomla.jQuery("#givebacks").append(o),0==t&&(t=1,a=i)}givebackDetails=e,1==t?(techjoomla.jQuery("#show_giveback_box").show(),""!=e[a].description&&techjoomla.jQuery("#hide_giveback_desc").removeClass("d-none")):techjoomla.jQuery("#show_giveback_box").hide()},error:function(){}})}))},fillprofiledata:function(e){""!=e.first_name&&jQuery("#first_name").val(e.first_name),""!=e.last_name&&jQuery("#last_name").val(e.last_name),""!=e.paypal_email&&jQuery("#paypal_email").val(e.paypal_email),""!=e.address&&jQuery("#address").val(e.address),""!=e.address2&&jQuery("#address2").val(e.address2),""!=e.paypal_email&&jQuery("#address2").val(e.paypal_email),""!=e.address2&&jQuery("#address2").val(e.address2),""!=e.zip&&jQuery("#zip").val(e.zip),""!=e.phone&&jQuery("#phone").val(e.phone)},otherCity:function(){!0===document.adminForm.other_city_check.checked?(jQuery("#other_city").show("slow"),jQuery("#hide_city").hide("slow")):(jQuery("#hide_city").show("slow"),jQuery("#other_city").hide("slow"))},populateGiveback:function(){var e=techjoomla.jQuery("#givebacks").val(),t=techjoomla.jQuery("#campaign_id").val();if("edit_amount"==e&&techjoomla.jQuery("#giveback_des").text(Joomla.Text._("COM_JGIVE_GIVE_NOT_AVIL_FOR_THIS_AMOUNT")),0!=e)for(var a=0;a<givebackDetails.length;a++)givebackDetails[a].id==e&&(techjoomla.jQuery("#donation_amount").val(parseFloat(givebackDetails[a].amount)),techjoomla.jQuery("#giveback_des").text(Joomla.Text._("COM_JGIVE_GIVEBACK_DESC")+" : "+givebackDetails[a].description),com_jgive.UI.Donation.updatePlatformFee(document.getElementById("donation_amount"),t));else techjoomla.jQuery("#donation_amount").val(window.minimun_amount),techjoomla.jQuery("#hide_giveback_desc").addClass("d-none"),com_jgive.UI.Donation.updatePlatformFee(document.getElementById("donation_amount"),t)},noGiveBack:function(){null==techjoomla.jQuery("input:checkbox[name=no_giveback]:checked").val()?(techjoomla.jQuery("#hide_giveback").show("slow"),techjoomla.jQuery("#hide_giveback_desc").show("slow")):(techjoomla.jQuery("#hide_giveback").hide("slow"),techjoomla.jQuery("#hide_giveback_desc").hide("slow"))},validateGiveBackAmount:function(e){var t=techjoomla.jQuery("input:checkbox[name=no_giveback]:checked").val(),a=techjoomla.jQuery("#givebacks").val();if(null==t)for(var o=0;o<givebackDetails.length;o++)if(givebackDetails[o].id==a){var i=givebackDetails[o].amount;return e>=i||(alert(Joomla.Text._("COM_JGIVE_AMOUNT_SHOULD_BE")+i),!1)}return!0},jGive_toggle_checkout:function(e){0==parseInt(e)?(techjoomla.jQuery(".jgive_select_user").show(),techjoomla.jQuery("#donor_name").addClass("required"),techjoomla.jQuery("#donor_id").addClass("required")):1==parseInt(e)&&(techjoomla.jQuery(".jgive_select_user").hide(),techjoomla.jQuery("#donor_name").removeClass("required"),techjoomla.jQuery("#donor_id").removeClass("required"),techjoomla.jQuery("#donor_name").removeClass("invalid"),techjoomla.jQuery("#donor_id").removeClass("invalid"),techjoomla.jQuery("#donor_id").val(),techjoomla.jQuery("#donor_name").val())},jGive_RecurDonation:function(e){0==e?(techjoomla.jQuery("#recurring_freq_div").hide("slow"),techjoomla.jQuery("#recurring_count_div").hide("slow"),techjoomla.jQuery("#recurring_count").removeClass("required")):1==e&&(techjoomla.jQuery("#recurring_count").addClass("required"),techjoomla.jQuery("#recurring_freq_div").show("slow"),techjoomla.jQuery("#recurring_count_div").show("slow"))},chkmail:function(e){techjoomla.jQuery.ajax({url:"?option=com_jgive&task=donations.chkmail&email="+e+"&tmpl=component&format=raw",type:"GET",dataType:"json",success:function(e){1==e[0]?(techjoomla.jQuery("#email_reg").html(e[1]),techjoomla.jQuery("#button-billing-info").attr("disabled","disabled")):(techjoomla.jQuery("#email_reg").html(""),techjoomla.jQuery("#button-billing-info").removeAttr("disabled"))}})}}},jgiveCommon={selectstatusorder:function(e,t){var a=t.selectedIndex,o=t.options[a].value;document.getElementById("hidid").value=e,document.getElementById("hidstat").value=o,Joomla.submitform("donations.save",document.getElementById("adminForm"))},lifetimeCampaign:function(){const e=document.querySelector("input[name='jform[start_date]']"),t=document.querySelector("input[name='jform[end_date]']"),a=t.closest(".form-group")||t.closest("div.control-group"),o=document.querySelector("form");function i(){const i=e.value,n=i?new Date(i):new Date;n.setFullYear(n.getFullYear()+100);const l=`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}-${String(n.getDate()).padStart(2,"0")} ${String(n.getHours()).padStart(2,"0")}:${String(n.getMinutes()).padStart(2,"0")}`;if(t.value=l,"none"===a.style.display){r();const e=document.createElement("input");e.type="hidden",e.name="jform[end_date]",e.value=l,o.appendChild(e)}}function r(){const e=document.querySelector('input[type="hidden"][name="jform[end_date]"]');e&&e.remove()}function n(){const e=document.querySelector("input[name='jform[lifetimecamp]']:checked")?.value;if("1"===e)i(),(o=t).removeAttribute("required"),o.classList.remove("validate-enddateverify"),a.style.display="none";else{!function(e){e.setAttribute("required","true"),e.classList.add("validate-enddateverify")}(t),a.style.display="";const e=new Date(t.value),o=new Date,i=new Date;i.setFullYear(o.getFullYear()+99),e.getFullYear()>=i.getFullYear()&&(t.value=""),r()}var o}document.querySelectorAll("input[name='jform[lifetimecamp]']").forEach((e=>{e.addEventListener("change",n)})),e.addEventListener("change",(()=>{const e=document.querySelector("input[name='jform[lifetimecamp]']:checked")?.value;"1"===e&&i()})),o&&o.addEventListener("submit",(()=>{const e=document.querySelector("input[name='jform[lifetimecamp]']:checked")?.value;"1"===e?(i(),console.log("Lifetime campaign submitted. End Date:",t.value)):console.log("Normal campaign submitted. End Date:",t.value)})),n()},copyShareLink:function(){document.getElementById("campaignLink").select(),document.execCommand("copy"),document.getElementById("copyCampaignLinkMsg").style.display="block"},getRoundedAmount:function(e,t){return jQuery.ajax({type:"GET",dataType:"json",async:!1,url:t+"index.php?option=com_jgive&task=donations.getRoundedValue&amount="+e,success:function(e){}}),""},validateAmountAsPerCurrency:function(e,t="no",a=0){if("yes"==t&&a>0&&(parseInt(jQuery(e).val())<a?(jQuery(".pan").addClass("d-none"),jQuery("#pannumber").removeClass("required")):(jQuery("#pannumber").addClass("required"),jQuery(".pan").removeClass("d-none"))),hidden_allow_high_value_donation=jQuery("#hidden_allow_high_value_donation").val(),hidden_max_allow_high_donation_value=jQuery("#hidden_max_allow_high_donation_value").val(),jQuery(e).hasClass("check-amount-limit")&&0==hidden_allow_high_value_donation&&parseInt(jQuery(e).val())>hidden_max_allow_high_donation_value)return jQuery("#amoutExceedModal").modal("show"),void jQuery(e).val("");let o=jgiveCommon.getRoundedAmount(jQuery(e).val(),jgiveBaseUrl);if(o){jQuery(e.id).focus();let t=Joomla.Text._("COM_JGIVE_INVALID_FIELD").concat(o);return Joomla.renderMessages({error:[t]}),jQuery("html, body").animate({scrollTop:0},500),!1}return!0},validations:{validationEndDate:function(e){var t=jQuery(e).val(),a=jQuery("#jform_start_date").val();jQuery(document).ready((function(){document.formvalidator.setHandler("enddateverify",(function(e){return a<t}))}))},validationAmount:function(){var e=jQuery("#jform_goal_amount").val(),t=jQuery("#jform_minimum_amount").val();jQuery(document).ready((function(){document.formvalidator.setHandler("Goalamount",(function(){return Number(e)>Number(t)})),document.formvalidator.setHandler("minimumamount",(function(){return Number(e)>Number(t)}))}))},validationGiveawayAmount:function(e){var t=jQuery("#jform_minimum_amount").val();t>0&&jQuery(document).ready((function(){document.formvalidator.setHandler("giveawayAmount",(function(){return Number(t)<=Number(e.value)}))}))}},campaignForm:{save:function(e){var t=jQuery("#jform_goal_amount").val(),a=jQuery("#jform_minimum_amount").val(),o=jQuery("#jform_max_donors").val(),i=jQuery("#jform_end_date").val(),r=jQuery("#jform_start_date").val(),n=(jQuery("#jform_campaign_old_image").val(),jQuery("#jform_campaign_image").val(),jQuery("#jform_days_limit").val()),l=(jQuery("#jform_image").val(),!0),s=jQuery("#jform_terms_condition").is(":checked");if("campaign.cancel"==e||"campaign.close"==e)return!1;if(0==isAdmin&&0!=termsConditionsConfig&&0!=termsConditionsArticleId&&!1===s){let e=Joomla.Text._("COM_JGIVE_CHECK_TERMS");return Joomla.renderMessages({error:[e]}),jQuery("html, body").animate({scrollTop:0},500),!1}if(jQuery("input,textarea,select").filter("[required]:visible").not(":input[type=file]").each((function(){jQuery(this).val()||(l=!1)})),!1===l){var u=Joomla.Text._("COM_JGIVE_CREATE_CAMPAIGN_VALIDATION_FAIL_MSG");return Joomla.renderMessages({error:[u]}),jQuery("html, body").animate({scrollTop:0},500),!1}{if(jgiveCommon.validateAmountAsPerCurrency(jQuery("#jform_goal_amount")),Number(t)<Number(a)){var m=Joomla.Text._("COM_JGIVE_CREATE_CAMPAIGN_MINDONATION_FAIL_MSG");return Joomla.renderMessages({error:[m]}),jQuery("html, body").animate({scrollTop:0},500),!1}if((null!=o||null!=o)&&Number(o)<0||(null!=o||null!=o)&&Number(a)<0){var d=Joomla.Text._("COM_JGIVE_CREATE_CAMPAIGN_NEGATIVE_NUMBER_ERROR_MSG");return Joomla.renderMessages({error:[d]}),jQuery("html, body").animate({scrollTop:0},500),!1}if(r>i){var c=Joomla.Text._("COM_JGIVE_CREATE_CAMPAIGN_DATEVALIDATION_FAIL_MSG");return Joomla.renderMessages({error:[c]}),jQuery("html, body").animate({scrollTop:0},500),!1}if(a>0){jQuery(".subform_givebacks_amount").each((function(){var e=jQuery(this).val();if(parseFloat(a)>parseFloat(e)){var t=Joomla.Text._("COM_JGIVE_CREATE_CAMPAIGN_GIVEAWAY_FAIL_MSG");return Joomla.renderMessages({error:[t]}),jQuery("html, body").animate({scrollTop:0},500),!1}}))}if(isNaN(n)||parseInt(n)<=0){var j=Joomla.Text._("COM_JGIVE_CAMPAIGNFORM_END_DATE_DAYS_LIMIT_INVALID_INPUT");return Joomla.renderMessages({error:[j]}),jQuery("html, body").animate({scrollTop:0},500),!1}const l=jQuery("#jform_amount_suggestions_tags").val().trim();if(""!==l){const e=l.split(",");for(var _=!0,g=0;g<e.length;g++){const[t,a]=jgiveCommon.campaignForm.validateAmountSuggestion(e[g]);if(t){alert(a),_=!1;break}}if(!_)return _}return Joomla.submitform(e),!0}},validateAmountSuggestion:function(e){var t=e;if(/^\d+$/.test(t)){var a=jQuery("#jform_minimum_amount").val(),o=jQuery("#jform_goal_amount").val();return 0!=a&&parseInt(t)<a?[!0,Joomla.Text._("COM_JGIVE_AMOUNT_SUGGESTION_VALIDATION_FAILED_MESSAGE_MIN_AMOUNT")]:0!=o&&parseInt(t)>o?[!0,Joomla.Text._("COM_JGIVE_AMOUNT_SUGGESTION_VALIDATION_FAILED_MESSAGE_MAX_AMOUNT")]:[!1,""]}return[!0,Joomla.Text._("COM_JGIVE_AMOUNT_SUGGESTION_VALIDATION_FAIL_MESSAGE")]}},reportForm:{submit:function(e){if("reportform.cancel"==e)Joomla.submitform(e,document.getElementById("adminForm"));else{if("reportform.save"!=e||!document.formvalidator.isValid(document.getElementById("adminForm")))return!1;Joomla.submitform(e,document.getElementById("adminForm"))}}},filters:{submitFilters:function(e){let t=window.location.href,a=jQuery("#"+e).serializeArray();var o=t.split("?");let i=o[0];var r={};null!=o[1]&&(o=o[1].split("&"),jQuery.each(o,(function(e,t){let a=t.split("=");null!=a[1]&&a[1]&&(r[a[0]]=a[1])}))),jQuery.each(a,(function(e,t){"-1"!=jQuery.inArray(t.name,tjListFilters)&&(""!=t.value?r[t.name]=t.value:"filter_campaign_countries"==t.name?(delete r.filter_campaign_states,delete r.filter_campaign_city):"filter_campaign_states"==t.name?delete r.filter_campaign_city:delete r[t.name])}));var n="";let l=0;jQuery.each(r,(function(e,t){n+=0==l?"?"+e+"="+t:"&"+e+"="+t,l++})),window.location=i+n}},getPanVerification:function(e){return jQuery.ajax({type:"GET",dataType:"json",async:!1,url:jgiveBaseUrl+"index.php?option=com_jgive&task=donations.panVerification&pannumber="+e,success:function(e){if(jgive.donations.hiderequestProcessingImg(),e.data.length>0){const t=e.data[0];if("success"===t.status)alert(t.message);else if("error"===t.status)return alert(t.message),jQuery("#pannumber").val(""),!1}else{const t=e.data;if("error"==t.status)return alert(t.message),jQuery("#pannumber").val(""),!1}}}),""}},tjMediaFile={validateImageUploadLimit:function(){return jQuery("*[class*=media_image_width]:visible").length<allowedMediaCount},validateVideoUploadLimit:function(){return jQuery("*[class*=media_video_width]:visible").length<allowedVideoCount},validateFile:function(e,t,a){var o=jQuery(e).attr("type");jQuery("#system-message-container").empty();var i=0;if("file"==o){var r=jQuery(e)[0].files[0];if(void 0!==r){var n=r.type.split("/"),l=allowedFileExtensions.split(",");if("image"===n[0])!1===tjMediaFile.validateImageUploadLimit()&&(i="imageUploadLimitExceed"),mediaSize=imageUploadLimit,r.size/1e3>mediaSize&&(i="imageSizeLimitExceed");else if("video"===n[0]){if(0==tjMediaFile.validateVideoUploadLimit()){var s=[Joomla.Text._("COM_JGIVE_VIDEO_UPLOAD_LIMIT_EXCEED")];return Joomla.renderMessages({warning:s}),jQuery("html, body").animate({scrollTop:0},500),!1}mediaSize=videoUploadLimit,(r.size/1e6>mediaSize||-1===jQuery.inArray(n[1],l))&&(i="videoSizeLimitExceed")}else{s=[Joomla.Text._("COM_JGIVE_MEDIA_INVALID_FILE_TYPE")];Joomla.renderMessages({warning:s}),jQuery("html, body").animate({scrollTop:0},500)}if(""!=i){if("imageUploadLimitExceed"===i){s=[Joomla.Text._("COM_JGIVE_IMAGE_UPLOAD_LIMIT_EXCEED")];Joomla.renderMessages({warning:s}),jQuery("html, body").animate({scrollTop:0},500)}else s=[Joomla.Text._("COM_JGIVE_MEDIA_UPLOAD_ERROR")],Joomla.renderMessages({warning:s}),jQuery("html, body").animate({scrollTop:0},500);return!1}tjMediaFile.uploadFile(r,e,o,t,a)}}else{if(!1===tjMediaFile.validateVideoUploadLimit()&&(i="videoUploadLimitExceed"),"videoUploadLimitExceed"===i)return s=[Joomla.Text._("COM_JGIVE_VIDEO_UPLOAD_LIMIT_EXCEED")],Joomla.renderMessages({warning:s}),jQuery("html, body").animate({scrollTop:0},500),!1;var u=jQuery("#jform_gallery_link").val();if(!(u=tjMediaFile.validateUrl(u))){s=[Joomla.Text._("COM_TJMEDIA_VALIDATE_URL")];return Joomla.renderMessages({warning:s}),jQuery("html, body").animate({scrollTop:0},500),!1}tjMediaFile.uploadFile(u,e,"link",t,a)}},uploadFile:function(e,t,a,o,i){var r=new FormData;"file"==a?(r.append("file[]",e),r.append("upload_type",a),r.append("isGallary",o)):"link"==a&&(r.append("upload_type",a),r.append("name",e.link),r.append("type",e.type));var n=Joomla.getOptions("system.paths").base+"/index.php?option=com_jgive&format=json&task=campaignform.uploadMedia&tmpl=component";this.ajaxObj=jQuery.ajax({type:"POST",url:n,dataType:"JSON",contentType:!1,processData:!1,data:r,xhr:function(){var e=jQuery.ajaxSettings.xhr();return e.upload&&e.upload.addEventListener("progress",(function(e){if(e.lengthComputable){var a=Math.floor(e.loaded/e.total*100);tjMediaFile.progressBar.updateStatus(t.id,a)}}),!1),e},beforeSend:function(e){tjMediaFile.progressBar.init(t.id,"")},success:function(e){if(1==o&&("video.youtube"==e.data[0].type||"video.vimeo"===e.data[0].type?jQuery("#jform_gallery_link").val(""):jQuery(t).val("")),e.success){var a=t.id,i=document.forms.adminForm;a.includes("givebacks")&&jQuery(i).append('<input type="hidden" name="'+t.name+'" value="'+e.data[0].id+'" />'),a.includes("beneficiaryStories")&&jQuery(i).append('<input type="hidden" name="'+t.name+'" value="'+e.data[0].id+'" />'),jQuery("#jform_title").length>0&&jQuery(i).append('<input type="hidden" name="jform[media_id]" value="'+e.data[0].id+'" />'),tjMediaFile.previewFile(e.data[0],o,t),tjMediaFile.progressBar.statusMsg(t.id,"success",e.message)}else jQuery(t).val(""),jQuery("#"+t.id).siblings(".progress").remove(),tjMediaFile.progressBar.statusMsg(t.id,"error",e.message)},error:function(e,a,o){if(0===i){var r=[Joomla.Text._("COM_JGIVE_MEDIA_INVALID_FILE_TYPE")];return Joomla.renderMessages({warning:r}),jQuery("html, body").animate({scrollTop:0},500),!1}tjMediaFile.progressBar.statusMsg(t.id,"error",o)}})},previewFile:function(e,t,a){if(e.id)if(1==t)tjMediaFile.tjMediaGallery.appendMediaToGallary(e);else{a.id.includes("jform_image")&&(jQuery("#uploaded_media").attr("src",e[campaignMainImage]),jQuery("#uploaded_media").closest(".thumbnails").removeClass("hide_jgdiv"),jQuery("#jform_campaign_old_image").val(jQuery("#jform_campaign_image").val()),jQuery("#jform_campaign_image").val(e.id))}return!1},defaultMedia:function(e,t){var a=jQuery(e).attr("data-info"),o=[];jQuery("#gallery_media input[data-info]").each((function(){var e=jQuery(this).attr("data-info");null!=typeof e&&(e!==a?o.push({mediaId:e,default:0}):o.push({mediaId:a,default:1}))})),tjMediaFile.setDefaultMedia(o,t)},setDefaultMedia:function(e,t){url=Joomla.getOptions("system.paths").baseFull+"index.php?option=com_jgive&format=json&task=campaignform.setDefaultMedia",jQuery.ajax({type:"POST",url:url,dataType:"JSON",data:{mediaIds:e,cid:t},success:function(e){alert(Joomla.Text._("COM_TJMEDIA_MEDIA_SET_TO_DEFAULT"))},error:function(e){alert(Joomla.Text._("COM_TJMEDIA_MEDIA_SET_TO_DEFAULT_ERROR"))}})},validateUrl:function(e){if(null!=e||""!=e){var t=[];if((a=e.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=|\?v=)([^#\&\?]*).*/))&&11==a[2].length)return t.link="https://www.youtube.com/embed/"+a[2]+"?enablejsapi=1",t.type="youtube",t;var a;return!!(a=e.match(/(?:www\.|player\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/(?:[^\/]*)\/videos\/|album\/(?:\d+)\/video\/|video\/|)(\d+)(?:[a-zA-Z0-9_\-]+)?/i))&&(t.link="https://player.vimeo.com/video/"+a[1],t.type="vimeo",t)}},progressBar:{init:function(e,t){""!==e&&(jQuery("#"+e).siblings(".alert").remove(),jQuery("#"+e).siblings(".progress").remove()),this.progress=jQuery("<div class='progress progress-striped progress-bar-success active'><div class='bar'></div><button onclick='return tjexport.abort();' class='btn btn-danger btn-small pull-right'>Abort</button></div>"),this.statusBar=this.progress.find(".bar"),this.abort=jQuery("<div class='abort'><span>Abort</span></div>").appendTo(this.statusbar),jQuery(".creatcamp__imgprogress").html(this.progress),"jform_image"==e&&(jQuery("#campaign-progress-bar").length>0?jQuery("#campaign-progress-bar").removeClass("d-none"):jQuery(".creatcamp__imgprogress").parent().removeClass("d-none"))},updateStatus:function(e,t){this.statusBar.css("width",t+"%"),this.statusBar.text(t+"%")},abort:function(){if(!confirm(Joomla.Text._("LIB_TECHJOOMLA_CSV_EXPORT_CONFIRM_ABORT")))return!1;this.ajaxObj.abort()},statusMsg:function(e,t,a){setTimeout((function(){""!==e&&jQuery("#"+e).siblings(".progress").remove()}),2e3);var o=jQuery("<div class='alert alert-"+t+"'><strong>"+a+"</strong><a href='#' class='close' data-dismiss='alert' aria-label='close' title='close'>×</a></div>");""!==e&&jQuery("#"+e).closest(".controls").append(o)}},tjMediaGallery:{appendMediaToGallary:function(e){var t=jQuery(".media_gallary_parent .clone_media:first-child").clone(),a=e.type.split("."),o="";"video"===a[0]?(o="<video width='100%' height='100%' class='media_video_width' preload='none' controls><source src="+e.media+"></video>","youtube"!==a[1]&&"vimeo"!==a[1]||(o="<iframe width='100%' class='media_video_width' height='100%' src="+e.source+"> </iframe>")):"image"===a[0]&&(o="<div class='media_image_width af-d-block bg-center af-bg-contain af-bg-repn af-responsive-embed af-responsive-embed-16by9' style='background-image: url("+e.media+");'></div>"),t.removeClass("hide_jgdiv"),t.find(".thumbnail").append(o),t.find(".media_field_value").val(e.id),t.find(".media_field_value").attr("id","media_id_"+e.id),t.find("#jform_default_video").attr("data-info",e.id),e.hasOwnProperty("params")&&""!==e.params&&1==JSON.parse(e.params).default&&t.find("#jform_default_video").attr("checked",!0),t.find("#delete_media").attr("data-info",e.id),t.appendTo(".media_gallary_parent")},deleteMedia:function(e,t,a,o,i){let r=jQuery(e),n=jQuery(e).attr("data-info"),l=Joomla.getOptions("system.paths").baseFull+"index.php?option=com_jgive&format=json&task=campaignform.deleteMedia&"+a+"=1";if(t&&(l=Joomla.getOptions("system.paths").baseFull+"index.php?option=com_jgive&format=json&task=campaignform.deleteMedia&"+a+"=1"),!confirm(Joomla.Text._("COM_JGIVE_CONFIRM_DELETE_MEDIA")))return!1;jQuery.ajax({type:"POST",url:l,dataType:"JSON",data:{id:n,client:o,clientId:i},success:function(e){r.closest(".clone_media").remove()},error:function(t,a,o){tjMediaFile.progressBar.statusMsg(e.id,"error",o)}})}}};